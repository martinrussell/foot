<!DOCTYPE html>
<html lang="en">
  <head>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <!-- jQuery library -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- DataTables CSS and JS -->
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css"
    />
    <script
      type="text/javascript"
      charset="utf8"
      src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"
    ></script>

    <script src="https://cdn.tailwindcss.com"></script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Team Details</title>


    <style>
/* Body and Background */
body {
    font-family: Arial, sans-serif;
    background-color: #ffffff!important;
    color: black!important;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
}

/* Container Styles */
.team-info-container {
  background-color: #ffffff!important;
  border-radius: 8px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
  text-align: center;
  padding: 2em;
  width: 90%;
  max-width: 800px;
}

.team-info-header h2 {
  font-size: 24px;
  color: black;
  margin-bottom: 0.5em;
}

.team-info-content {
  font-size: 16px;
  color: #bbbbbb;
}

.team-color-badge {
  display: inline-block;
  margin: 0.5em;
  padding: 0.25em 0.5em;
  color: #ffffff;
  border-radius: 4px;
  font-size: 16px;
  font-weight: bold;
}

/* Buttons Styles */
.button-group button {
  background-color: #292929;
  color: #ffffff;
  border: 2px solid #545454;
  padding: 8px 16px;
  font-size: 16px;
  margin: 5px;
  border-radius: 4px;
}

.button-group button:hover {
  background-color: #545454;
  color: #ffffff;
}

/* Table Styles */
#myTable {
  border-collapse: collapse;
  margin: 0 auto;
  background-color: #292929;
  font-size: 14px;
  width: 100%;
  border: 2px solid #545454;
  border-radius: 4px;
  overflow: hidden;
}

#myTable thead th {
  background-color: #292929;
  color: #ffffff;
  border-bottom: 2px solid #545454;
  padding: 8px;
}

#myTable tbody td {
  padding: 8px;
  text-align: center;
  border: 1px solid #545454;
}

#myTable tbody tr:nth-child(odd) {
  background-color: #1f1f1f;
}

#myTable tbody tr:hover {
  background-color: #333333;
}

/* Data Highlight Styles */
.highlight-green {
  background-color: #14b91d;
  color: #ffffff;
}

.highlight-dark-green {
  background-color: #0e6d0a;
  color: #ffffff;
}

.highlight-very-dark-green {
  background-color: #004000;
  color: #ffffff;
}

/* Minutes Played Style */
#myTable tbody tr td:first-child {
  font-weight: bold;
  color: black;
}

/* Filter Button Styles */
.filters-container {
  text-align: center;
  margin-bottom: 10px;
}

/* Players Button Style */
button[data-players] {
  padding: 8px 16px;
  font-size: 16px;
  background-color: #292929;
  color: #ffffff;
  border: 2px solid #545454;
  border-radius: 4px;
}

/* Buttons Color Style */
button[data-players]:hover,
button[data-players].active {
  background-color: #545454;
}

/* Show Starting XI Button Style */
button[data-starting] {
  padding: 8px 16px;
  font-size: 16px;
  background-color: #292929;
  color: #ffffff;
  border: 2px solid #545454;
  border-radius: 4px;
}

/* Starting XI Button Color Style */
button[data-starting]:hover,
button[data-starting].active {
  background-color: #545454;
}
/* Body and Background */
body {
  font-family: Arial, sans-serif;
  background-color: #0a0a0a;
  color: #ffffff;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column; /* Change the flex direction to column */
  align-items: center;
  min-height: 100vh;
}

/* Container Styles */
.team-info-container {
  display: flex;
  flex-direction: column; /* Align team info at the top */
  background-color: #1f1f1f;
  border-radius: 8px;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
  text-align: center;
  padding: 2em;
  width: 90%;
  max-width: 800px;
  margin-top: 2em; /* Add margin to move the container down from the top */
}

.team-info-header {
  /* No width needed for the header, it will expand to fit content */
}

.team-info-content {
  /* No width needed for the content, it will expand to fit content */
  font-size: 16px;
  color: #bbbbbb;
}

.team-color-badge {
  display: inline-block;
  margin: 0.5em;
  padding: 0.25em 0.5em;
  color: #ffffff;
  border-radius: 4px;
  font-size: 16px;
  font-weight: bold;
}
/* Update the CSS to remove white background and make text smaller */
#myTable {
  border-collapse: collapse;
  width: 100%;
  margin: 0;
  background-color: transparent; /* Remove white background */
  border: 1px solid #444;
  border-radius: 8px;
  overflow: hidden;
}

#myTable thead {
  background-color: #2d2d2d;
}

#myTable thead th {
  padding: 8px; /* Reduce padding */
  text-align: center;
  color: #ffffff;
  border-bottom: 2px solid #444;
  font-size: 10px; /* Reduce font size */
}

#myTable tbody td {
  padding: 8px; /* Reduce padding */
  text-align: center;
  font-weight: bold;
  color: black;
  border-bottom: 1px solid #444;
  font-size: 10px; /* Reduce font size */
  background: white;
}

#myTable tbody tr:nth-child(odd) {
  background-color: #111;
}

#myTable tbody tr:hover {
  background-color: #333;
}

.button-group button {
  padding: 6px 10px; /* Reduce button padding */
  font-size: 12px; /* Reduce button font size */
  border: none;
  margin: 5px;
  cursor: pointer;
  color: #ffffff;
}

.button-group button:hover {
  background-color: #333;
}

.highlight-win-green {
  background-color: #4caf50 !important;
}

.highlight-loss-red {
  background-color: #f44336 !important;
}

.highlight-draw-grey {
  background-color: #757575 !important;
}


/* Common button styles */
.btn-stat {
  padding: 8px 16px;
  font-size: 14px;
  font-weight: 600;
  border: 1px solid #d1d1d1;
  border-radius: 6px;
  transition: background-color 0.2s, color 0.2s;
  cursor: pointer;
  margin-bottom: 8px; /* Add space between buttons */
}

/* Styles for specific buttons */
.btn-stat.fouls {
  background-color: #ffffff;
  color: #000000;
}

.btn-stat.shots-off {
  background-color: #ffffff;
  color: #000000;
}

.btn-stat.shots-on {
  background-color: #ffffff;
  color: #000000;
}

.btn-stat.yellow-cards {
  background-color: #ffeb3b;
  color: #000000;
  border-color: #ffeb3b;
}

.btn-stat.red-card {
  background-color: #ff5722;
  color: #ffffff;
  border-color: #ff5722;
}

.btn-stat.starting-xi {
  background-color: #000000;
  color: #ffffff;
  border-color: #000000;
}






  </style>
  </head>

  <body>
</div>
<div class="container mx-auto mt-6">
  <div class="text-center mb-8">
    <h2 class="text-2xl font-bold">{{team.name}} - Player Statistics</h2>
    <div class="inline-flex mt-4 space-x-2" role="group">
      <button
        onclick="highlightData('[data-fouls]')"
        class="btn-stat fouls"
      >
        Fouls
      </button>
      <button
        onclick="highlightData('[data-shots-off]')"
        class="btn-stat shots-off"
      >
        Shots Off Target
      </button>
      <button
        onclick="highlightData('[data-shots-on]')"
        class="btn-stat shots-on"
      >
        Shots On Target
      </button>
      <button
        onclick="highlightData('[data-yellow]')"
        class="btn-stat yellow-cards"
      >
        Yellow Cards
      </button>
      <button
        onclick="highlightData('[data-red]')"
        class="btn-stat red-card"
      >
        Red Card
      </button>
    </div>
    <div class="mt-4">
      <button
        onclick="showRowsWithYes()"
        class="btn-stat starting-xi"
      >
        Starting XI (Confirmed)
      </button>
    </div>
  </div>
</div>

    <table
      id="myTable"
      class="table table-bordered table-striped table-hover small"
    >
      <thead>
      <tr>
     <th>Player Name</th>
     <th>Starting</th>
       <th>Position</th>
          {% for match in matches %}
          <th class="
    {% if match.winnerCode == 2 and team_id == match.awayTeam.id %}
      highlight-win-green
    {% elif match.winnerCode == 1 and team_id == match.awayTeam.id %}
      highlight-loss-red
    {% elif match.winnerCode == 1 and team_id == match.homeTeam.id %}
      highlight-win-green
    {% elif match.winnerCode == 2 and team_id == match.homeTeam.id %}
      highlight-loss-red
    {% elif match.winnerCode == 3 %}
      highlight-draw-grey
    {% endif %}
">
  {% if team_id == match.homeTeam.id %}
    {{ match.awayTeam.name }} (H)
    <br>
    {{ match.homeScore.current }} v {{ match.awayScore.current}}
     <br>
    {{match.tournament.name}}
  {% elif team_id == match.awayTeam.id %}
    {{ match.homeTeam.name }} (A)
    <br>
    {{ match.homeScore.current }} v {{ match.awayScore.current}}
    <br>
    {{match.tournament.name}}
  {% else %}
    <!-- Handle other cases or remove this block if not needed -->
  {% endif %}
</th>
          {% endfor %}
        </tr>
      </thead>

  </tr>

      <tbody>
        
        {% for player_data in players %}
        
        <tr>
          <td>
  <div style="display: flex; align-items: center;">
    <img 
      src="{{ url_for('static', filename='images/' + player_data.player.id ~ '_image.png') }}" 
      alt="Player Image" 
      style="width: 50px; height: 50px; object-fit: cover; margin-right: 10px;">
    {{ player_data.player.name }}
</td>     
<td>


{% set is_in_lineup = false %}
{% if lineups is defined and lineups.home is defined and lineups.away is defined and lineups.confirmed == True %}
  {% set home_players = lineups.home.players|default([]) %}
  {% set away_players = lineups.away.players|default([]) %}
  {% set all_lineups = home_players + away_players %}
  {% if all_lineups %}
    {% for player_lineup in all_lineups %}
      {% if player_data.player.id == player_lineup.player.id and not player_lineup.substitute %}
        {% set is_in_lineup = true %}
        Yes
      {% endif %}
    {% endfor %}
  {% endif %}
{% endif %}


</td>
      <td>{{ player_data.player.position }}</td>
          {% for match in matches %}
          <td>
            <!-- Was Fouled -->
            <div class="data-container">
              Was Fouled:
              <span data-was-fouled>
                {{ fouls_data.get(player_data.player.id, {}).get(match.id,
                {}).get('wasFouled', 'No data') }}
              </span>
            </div>

            <!-- Fouls -->
            <div class="data-container">
              Fouls:
              <span data-fouls>
                {{ fouls_data.get(player_data.player.id, {}).get(match.id,
                {}).get('fouls', 'No data') }}
              </span>
            </div>

            <!-- Shots Off Target -->
            <div class="data-container">
              Shots Off Target:
              <span data-shots-off>
                {{ fouls_data.get(player_data.player.id, {}).get(match.id,
                {}).get('shotOffTarget', 'No data') }}
              </span>
            </div>

            <!-- Shots On Target -->
            <div class="data-container">
              Shots On Target:
              <span data-shots-on>
                {{ fouls_data.get(player_data.player.id, {}).get(match.id,
                {}).get('shotOnTarget', 'No data') }}
              </span>
            </div>

            <!-- Yellow Cards -->
            <div class="data-container">
              Yellow Cards:
              <span data-yellow>
                {{ cards_data.get(player_data.player.id, {}).get(match.id,
                {}).get('yellowCardsCount', 0) }}
              </span>
            </div>
            <!-- Red Card -->
            <div class="data-container">
              Red Card:
              <span data-red>
                {{ 'Yes' if cards_data.get(player_data.player.id,
                {}).get(match.id, {}).get('redCard', False) else 'No' }}
              </span>
            </div>
            <!-- Minutes Played -->
            <div class="data-container-mins">
            <span data-minutes>
            {% set minutes = fouls_data.get(player_data.player.id, {}).get(match.id, {}).get('minutesPlayed', 'No data') %}
            {% if minutes is number %}
            <br>
              {{ minutes | round(0) }} mins
            {% else %}
              {{ minutes }}
            {% endif %}
          </span>
            </div>
          </td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </body>

  <script>
    function hideData() {
      // hide all data elements
      let allDataElements = document.querySelectorAll(".data-container");
      allDataElements.forEach((element) => {
        element.style.display = "none";
      });
    }

    function highlightData(selector) {
      hideData(); // hide all data elements
      clearHighlights(); // clear previous highlights

      let dataElements = document.querySelectorAll(selector);

      // Show the selected data elements and apply the necessary highlights
      dataElements.forEach((element) => {
        let value = parseInt(element.textContent);
        let container = element.closest(".data-container"); // get the parent container
        container.style.display = "block"; // Show the selected data elements

        if (value === 1) {
          container.classList.add("highlight-green");
        } else if (value === 2) {
          container.classList.add("highlight-dark-green");
        } else if (value > 2) {
          container.classList.add("highlight-very-dark-green");
        }
      });
    }

    function clearHighlights() {
      let highlighted = document.querySelectorAll(
        ".highlight-green, .highlight-dark-green, .highlight-very-dark-green"
      );
      highlighted.forEach((el) => {
        el.classList.remove(
          "highlight-green",
          "highlight-dark-green",
          "highlight-very-dark-green"
        );
      });
    }

    $(document).ready(function () {
      $("#myTable").DataTable();
    });

    $("#myTable").DataTable({
      paging: false,
      lengthChange: false, // Assuming the minutes played is the second column (0-indexed)
      ordering: false, // Disable sorting for all columns
      searching: false // This will remove the search box

    });


    function showRowsWithYes() {
  var table = document.getElementById('myTable'); // Get the table by its ID
  var rows = table.getElementsByTagName('tr'); // Get all table rows

  for (var i = 1; i < rows.length; i++) {
    var cell = rows[i].getElementsByTagName('td')[1]; // Get the 3rd cell (index 2)

    if (cell && cell.textContent.trim() !== 'Yes') {
      rows[i].style.display = 'none'; // Hide the row
    }
  }
}

highlightData('[data-fouls]')




  </script>
</html>
